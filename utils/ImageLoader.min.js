"use strict"; function ImageLoader(t) { var o = this, e = []; t.loading && (this.loadingcallback = t.loading), t.loaded && (this.loadedcallback = t.loaded), t.base && (base = t.base), this.load = function () { o.start = (new Date).getTime(), e.map(function (t) { var o = base ? base + t.src : t.src; wx.getImageInfo({ src: o, success: function (o) { t.status = !0 }, fail: function (o) { t.fail = !0 } }) }); var t = setInterval(function () { o.isLoaded() && clearTimeout(t) }, 200); setTimeout(function () { clearTimeout(t) }, 6e4) }, this.insert = function (t) { e.push(t) }, this.init = function (t) { var e = []; loop(t, e), console.log(e), e.map(function (t) { o.insert(new Img(t)) }), o.load() }, t.source && this.init(t.source), this.isLoaded = function () { var t = !0, a = 0, n = 0; return e.map(function (o) { o.status ? a += 1 : t = !1, o.fail && (t = !0, n += 1) }), t ? o.loadedcallback && o.loadedcallback({ status: !0, timecost: (new Date).getTime() - o.start, success: a, fail: n, totalcount: e.length }) : o.loadingcallback && o.loadingcallback({ status: !1, percent: a / e.length }), t } } var _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, base = 0, Img = function (t) { this.src = t, this.status = !1, this.fail = !1 }, loop = function t(o, e) { Object.keys(o).map(function (a) { "object" === _typeof(o[a]) ? t(o[a], e) : "BASE" === a ? base = o[a] : e.push(o[a]) }) }; module.exports = ImageLoader;